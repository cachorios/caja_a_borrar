


{% block collection_widget %}
    {% spaceless %}
        <div class="collection">

            {% if prototype is defined %}
                {% set attr = attr|merge({'data-prototype': block('collection_item_widget') }) %}
                {#block('collection_item_widget')#}
            {% endif %}

            <div {{ block('widget_container_attributes') }}>
                {{ form_errors(form) }}

                <table>
                    <thead>
                    <tr>
                        <th>Pos.</th>
                        <th>Long.</th>
                        <th>Descripcion</th>
                        <th>Tabla</th>
                        <th>Acti√≥n</th>
                    </tr>
                    </thead>
                    <tbody class="items">
                    {% for rows in form %}
                        <tr>
                            {% set fieldNum = 1 %}

                            {% for row in rows %}
                                <td>
                                <div class="field{{ fieldNum }}">
                                    {{ form_widget(row, { 'attr': { 'class': 'test' }}) }}
                                </div>
                                {% set fieldNum = fieldNum + 1 %}
                                </td>
                            {% endfor %}
                            <td>
                            <a class="remove" title="Remove" href="javascript:void()">
                                <span>Delete</span>
                            </a>
                            </td>

                        </tr>
                    {% endfor %}
                    </tbody>
                </table>
                {{ form_rest(form) }}

            </div>
            <div class="clear"></div>

            <button  class="btn btn-minit add_item" style="margin-top: 13px;">
                <span class="icon-plus"></span> Agregar</button>


        </div>

        <div class="clear"></div>

    {% endspaceless %}
    {{ block('collection_js')  }}
{% endblock collection_widget %}


{% block collection_item_widget %}
    {% spaceless %}
        {#<tr>#}
            {#<td colspan="5">#}
                {#{{ form_row(prototype) }}#}
            {#</td>#}
        {#</tr>#}

        <tr>
        {% set fieldNum = 1 %}
        {% for row in prototype %}
        <td>
        <div class="field{{ fieldNum }}">

        {{ form_widget(row, { 'attr': { 'class': 'test' }}) }}
        </div>
        </td>
        {% set fieldNum = fieldNum + 1 %}

        {% endfor %}
        <td>
        <a class="remove" title="Remove" href="javascript:void()">
        <span>Delete</span>
        </a>
        </td>
        </tr>

    {% endspaceless %}

{% endblock collection_item_widget %}

{% block collection_js %}

<script type="text/javascript">
    var collectionHolder = $('#caja_sistemacajabundle_codigobarratype_posiciones');

    var $addTagLink = $('button.add_item');
    var $contenedor = $("#caja_sistemacajabundle_codigobarratype_posiciones").find('tbody.items');

    jQuery(document).ready(function() {

        $addTagLink.on('click', function(e) {
            // prevent the link from creating a "#" on the URL
            e.preventDefault();

            // add a new tag form (see next code block)
            addTagForm(collectionHolder, $contenedor);
        });
    });

    function addTagForm(collectionHolder, $contenedor) {
        // Get the data-prototype explained earlier
        var prototype = collectionHolder.attr('data-prototype');

        // count the current form inputs we have (e.g. 2), use that as the new index (e.g. 2)
        var newIndex = collectionHolder.find(':input').length;

        // Replace '__name__' in the prototype's HTML to
        // instead be a number based on how many items we have
        var newForm = prototype.replace(/__name__/g, newIndex);

        // Display the form in the page in an li, before the "Add a tag" link li
        //var $newFormLi = $('<li></li>').append(newForm);

        //$("#caja_sistemacajabundle_codigobarratype_posiciones").find('tbody.items').append(newForm);
        $contenedor.append(newForm);
    }

</script>
{% endblock collection_js %}


